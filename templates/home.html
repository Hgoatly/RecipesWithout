{% extends "base.html" %}
{% block content %}
<div class="row">
  <div class="col s12" id="landing-page">
			<div class="section-text brown-text" id="main-heading">
                <span class="s12 center-align"><h1>Recipes Without</h1></span>
                <span class="s12 center-align"><h2 class="subtitle">Your online resource for allergen-free dining</h2></span>
        </div>
    </div> 
</div>
    <div class="row">
        <div class="col l10 offset-l1 brown-text center-align">
                <p class="welcome-text">
                    Welcome to Recipes Without. Here you can find a range of recipes suitable for those with
                    Gluten, Dairy or Egg allergies. As well as being able to search and view other people's recipes, you can
                    upload, edit
                    and delete your own. You can view a selection of recipes here, or visit an allergen specific page by clicking the recipes dropdown on the navbar. Please <a href="{{ url_for('register') }}" class="teal-text lighten-2">register</a> to start your own Recipes Without collection, 
                    or <a href="{{ url_for('login') }}" class="teal-text lighten-2">login</a> if you've already registered.
                </p>
            </div>
        </div>

        <!-- search -->
<div class="row" id="search-box">
    <div class="col card-panel s12 offest-s1 m6 offset-m3 search-card">
<form action="{{ url_for('search') }}" method="post" class="col s12 m10 center-align">
    <div class="row valign-wrapper center-align">
        <div class="input-field col s12 m10 offset-m1">
            <i class="fas fa-search prefix"></i>
            <input type="text" name="query" id="query" minlength="3" class="validate" required> 
            <label for="query">Search Recipes</label>
        </div>
          <button type="submit" class="btn teal lighten-3" id="search-button" aria-label="search">
                <i class="fas fa-search"></i>
            </button>  
        </div>
</form>
</div>
</div>

<!-- advanced search -->
<div class="row" id="advanced-search-box">
<div class="col card-panel s12 offest-s1 m6 offset-m3 search-card">
    <h4 class="col s12 m10 offset-m1 center-align">Advanced Search</h4>
 <form action="{{ url_for('advanced_search') }}" method="post">
            <div class="input-field col s12 m10 offset-m1">
            <i class="fas fa-search prefix"></i>
            <input type="text" name="advanced-query" id="advanced-query" minlength="3" class="validate" required> 
            <label for="advanced-query">Search Recipes</label>
        </div>
<div class="col s12 m10 offset-m1">
    <p>    
        <label for="gluten_free_search">
            <input type="checkbox" name="gluten_free-search" id="gluten_free_search"/>
            <span>Gluten Free</span>
        </label>
    </p>
    <p>
        <label for="dairy_free_search">
            <input type="checkbox" name="dairy_free_search" id="dairy_free_search"/>
            <span>Dairy Free</span>
        </label>
    </p>
    <p>
        <label for="egg_free_search">
            <input type="checkbox" name="egg_free_search" id="egg_free_search"/>
            <span>Egg Free</span>
        </label>
    </p>
  </div>
        <div class="row">
    <div class="col s12 center-align">
<button type="submit" class="btn teal lighten-3" id="advanced-search-button" aria-label="advanced-search">Search</button>
</div>
</div>
</form>
</div>
</div>

 <div class="row">
    <div class="col s12 center-align">
<button class="btn teal lighten-3" id="show-advanced-search" aria-label="show-advanced-search">Advanced Search</button>
</div>
</div>

 <div class="row">
    <div class="col s12 center-align">
<button class="btn teal lighten-3" id="show-basic-search" aria-label="show-basic-search">Basic Search</button>
</div>
</div>

<!-- home button -->
<div class="row">
    <div class="col s12 center-align">
<a href="{{ url_for('home') }}" class="btn teal lighten-3">Cancel</a>
</div>
</div>

<!-- recipe cards -->
    <div class="row hide-on-small-only">
           {% for recipe in recipes %}
           <div class="col s12 m6 l4 center-align">
            <div class="card-panel large">  
          <div class="card-title brown-text truncate">{{ recipe.recipe_name }}</div>

          <img src="{{ recipe.image }}" loading="lazy" alt="{{ recipe.alt }}" class="card-image">
        
          <div class="card-buttons">
          <a href="{{ url_for('recipe', recipe_id=recipe._id) }}" class="btn teal lighten-3">View Recipe</a>
          </div>
          {% if session.user %}
    {% if recipe._id in user_upvotes %}
          <button class="btn teal lighten-3 vote-buttons"><a href="{{ url_for('downvotes', recipe_id=recipe._id) }}" class="white-text"><i class="fas fa-thumbs-down"></i> {{ recipe.downvotes }}</a></button>
    {% elif recipe._id in user_downvotes%}
          <button class="btn teal lighten-3 vote-buttons"><a href="{{ url_for('upvotes', recipe_id=recipe._id) }}" class="white-text"><i class="fas fa-thumbs-up"></i> {{ recipe.upvotes }}</a></button>
    {% else %}
          <button class="btn teal lighten-3 vote-buttons"><a href="{{ url_for('upvotes', recipe_id=recipe._id) }}" class="white-text"><i class="fas fa-thumbs-up"></i> {{ recipe.upvotes }}</a></button>
          <button class="btn teal lighten-3 vote-buttons"><a href="{{ url_for('downvotes', recipe_id=recipe._id) }}" class="white-text"><i class="fas fa-thumbs-down"></i> {{ recipe.downvotes }}</a></button>
          {% endif %}  
    {% endif %} 
         
      </div>
    </div>      
           {% endfor %}
    </div>

     
    <div class="hide-on-med-and-up">
        <ul class="collapsible brown-text">
        {% for recipe in recipes %}
    <li>
      <div class="collapsible-header grey lighten-5"><i class="fas fa-concierge-bell brown-text"></i>{{ recipe.category_name.title() }}: {{ recipe.recipe_name.title() }}</div>
      <div class="collapsible-body">
          <div class="col s12 center-align">
      <div class="card-panel large">
          <img src="{{ recipe.image }}" loading="lazy" alt="{{ recipe.alt }}" class="card-image">
        <div class="card-content">
          <p>I am a very simple card. I am good at containing small bits of information.
          I am convenient because I require little markup to use effectively.</p>
         
        </div>
        <div class="card-action">
          <a href="{{ url_for('dairy_free_recipe', recipe_id=recipe._id) }}" class="btn teal lighten-3">View Recipe</a>
        </div>
       
      </div>
    </div>
      </div>
    </li>
  {% endfor %}
  </ul>
  </div>
  
{% endblock %}